<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= user.username %>'s Profile
    </title>
</head>

<body>

    <h1>
        <%= user.username %>'s Profile
    </h1>

    <!-- Profile Picture -->
    <% if (user.profilePic) { %>
        <img src="<%= user.profilePic %>" alt="Profile Picture" width="150"><br><br>
        <% } else { %>
            <img src="/images/default-profile.png" alt="Default Picture" width="150"><br><br>
            <% } %>

                <!-- Bio -->
                <p><strong>Bio:</strong>
                    <%= user.bio || "No bio yet." %>
                </p>

                <!-- Followers / Following -->
                <p><strong>Followers:</strong>
                    <%= user.followers ? user.followers.length : 0 %>
                </p>
                <p><strong>Following:</strong>
                    <%= user.following ? user.following.length : 0 %>
                </p>

                <!-- Navigation -->
                <a href="/home">Homepage</a> |
                <a href="/users/edit-profile">Edit Profile</a> |
                <a href="/auth/logout">Logout</a>
                <br><br>

                <!-- Delete Account -->
                <form action="/users/delete?_method=DELETE" method="POST"
                    onsubmit="return confirm('Are you sure you want to delete your account? This cannot be undone.');">
                    <button type="submit" style="color: red;">Delete Account</button>
                </form>

                <hr>

                <!-- Create New Artwork -->
                <h2>My Artworks</h2>
                <a href="/artworks/new">Create New Artwork</a>
                <br><br>

                <!-- User's Artworks -->
                <% if (myArtworks && myArtworks.length> 0) { %>
                    <% myArtworks.forEach(artwork=> { %>

                        <p><strong><%= artwork.title %></strong></p>
                        
                        <a href="/artworks/<%= artwork._id %>">
                            <img src="<%= artwork.image %>" alt="<%= artwork.title %>" width="200">
                        </a>
                        <br>

                        <!-- Edit and Delete Buttons -->
                        <a href="/artworks/<%= artwork._id %>/edit">Edit</a>

                        <form action="/artworks/<%= artwork._id %>?_method=DELETE" method="POST" style="display:inline;"
                            onsubmit="return confirm('Are you sure by deleting this artwork?')">
                            <button type="submit">Delete</button>
                        </form>
                        <hr>
                        <% }) %>
                            <% } else { %>
                                <p>You haven't uploaded any artworks yet.</p>
                                <a href="/artworks/new">Upload your first artwork</a>
                                <% } %>

</body>

</html>